cmake_minimum_required(VERSION 3.30)

get_filename_component(GEL_INCLUDE_DIR ../.. ABSOLUTE)

add_executable(RsR_test RsR_test.cpp)
add_executable(OBJParser_test OBJParser_test.cpp)

set_target_properties(RsR_test OBJParser_test PROPERTIES
    CXX_STANDARD 20
    INCLUDE_DIRECTORIES "${GEL_INCLUDE_DIR};${DOCTEST_INCLUDE_DIR}"
    CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -fsanitize=undefined"
)
target_link_libraries(RsR_test PRIVATE GEL nanobench)
target_link_libraries(OBJParser_test PRIVATE GEL nanobench)

doctest_discover_tests(RsR_test TEST_PREFIX "RsR.")
#add_test(NAME GEL.Test.RsR COMMAND RsR_test)
doctest_discover_tests(OBJParser_test TEST_PREFIX "OBJParser.")
#add_test(NAME GEL.Test.OBJParser COMMAND OBJParser_test)

#add_test(NAME GEL.Test.RsRPython COMMAND ${PYTEST} "${CMAKE_CURRENT_SOURCE_DIR}/rsr.py")
#add_test(NAME GEL.Test.RsRPython COMMAND ${Python3_EXECUTABLE} "${CMAKE_CURRENT_SOURCE_DIR}/rsr.py")
